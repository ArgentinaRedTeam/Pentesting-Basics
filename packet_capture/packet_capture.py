import pyshark
import os

def capture_packets(interface, output_file):
    """
    ¡Es hora de ser un poco ninja con nuestra red! Este método pone a trabajar a PyShark
    para capturar los secretos que fluyen a través de la interfaz que elijas.
    Todo se guarda en un archivo PCAP, como un tesoro digital.
    """
    
    try:
        print(f"\n¡Atención! Ahora estamos capturando paquetes en la interfaz {interface}. Mantén la calma y observa...")
        capture = pyshark.LiveCapture(interface=interface, output_file=output_file)
        capture.sniff_continuously()  # Capturamos paquetes sin parar, ¡como detectives de redes!

    except pyshark.capture.capture.TSharkCrashException as e:
        print(f"¡Oops! TShark tuvo un tropiezo. Aquí está el problema: {e}")
    except KeyboardInterrupt:
        print("\n¡Captura de paquetes detenida! Alguien presionó Ctrl+C. Buena decisión si ya tenías suficiente.")

def main():
    print("Bienvenido al increíble mundo de la captura de paquetes con PyShark.")
    print("Asegúrate de tener Wireshark bien instalado y el camino despejado para el archivo PCAP.")

    interface = input("Dime, ¿qué interfaz quieres espiar hoy? (ejemplo: 'eth0' o 'wlan0'): ")
    output_file = input("Y necesito saber dónde guardar nuestro tesoro, el archivo PCAP (ejemplo: 'captura.pcap'): ")

    capture_packets(interface, output_file)

if __name__ == "__main__":
    main()
    print("Recuerda: ¡Usa este poder solo para el bien! © ART (Argentina Red Team), todos los derechos reservados.")
