import base64
import binascii
import urllib.parse
import codecs
import hashlib

# ¡Derechos Reservados ART! - Usá con sabiduría, ¡eh!
print("\n¡Bienvenido al Decodificador ART! - ¡Descifra los misterios del código!")
print("Recuerda: ¡El conocimiento es poder, pero úsalo con responsabilidad!\n")

def identify_encoding(input_str):
    """
    ¡Sherlock Holmes de los códigos! Intenta adivinar qué tipo de codificación tiene la cadena.
    """
    for encoding, func in {
        "Base64": base64.b64decode,
        "Hexadecimal": binascii.unhexlify,
        "URL Encoding": urllib.parse.unquote,
    }.items():
        try:
            func(input_str)
            return encoding
        except (binascii.Error, ValueError):
            pass

    # Probamos ROT13 (solo letras y números)
    if all(c.isalnum() for c in input_str):
        try:
            codecs.decode(input_str, 'rot_13')
            return "ROT13"
        except Exception:
            pass

    # Detección de hashes (MD5, SHA1)
    if len(input_str) == 32 and all(c in '0123456789abcdef' for c in input_str):
        return "MD5"
    elif len(input_str) == 40 and all(c in '0123456789abcdef' for c in input_str):
        return "SHA1"

    return "Desconocido - ¡Este código es un enigma!"

def decode(input_str, encoding):
    """
    ¡Manos a la obra! Decodifica la cadena según el tipo de codificación identificado.
    """
    if encoding == "Base64":
        return base64.b64decode(input_str).decode('utf-8', errors='replace')  # Manejo de errores
    elif encoding == "Hexadecimal":
        return binascii.unhexlify(input_str).decode('utf-8', errors='replace')
    elif encoding == "ROT13":
        return codecs.decode(input_str, 'rot_13')
    elif encoding == "URL Encoding":
        return urllib.parse.unquote(input_str)
    else:
        return "No se puede decodificar - ¡Es un misterio!"

def main():
    """
    ¡El show principal! Pide al usuario la cadena y la decodifica si es posible.
    """
    while True:
        input_str = input("\nIngresa la cadena misteriosa que quieres decodificar (o 'salir' para terminar): ")
        if input_str.lower() == 'salir':
            print("\n¡Nos vemos, capo! ¡Sigue rompiéndola!")
            break

        encoding = identify_encoding(input_str)
        print(f"Tipo de codificación detectado: {encoding}")

        decoded_str = decode(input_str, encoding)
        if decoded_str != "No se puede decodificar - ¡Es un misterio!":
            print(f"¡Eureka! El mensaje decodificado es: {decoded_str}")
        else:
            print(decoded_str)

if __name__ == "__main__":
    main()
