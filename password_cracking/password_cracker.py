import subprocess
import os

def crack_john(hash_file, wordlist=None):
    """
    ¡Desata el poder de John the Ripper! Este método utiliza John para descifrar contraseñas como un maestro.
    Si tienes un diccionario de palabras, John estará más feliz y eficiente.
    """
    command = ["john", hash_file]
    if wordlist:
        command.extend(["--wordlist", wordlist])
    subprocess.run(command)

def crack_hashcat(hash_file, hash_type, wordlist=None):
    """
    Aquí vamos con Hashcat, el tigre de los programas de cracking. 
    Dime qué tipo de hash es y, si quieres acelerar el proceso, pásame también un diccionario de palabras.
    """
    command = ["hashcat", "-m", hash_type, hash_file]
    if wordlist:
        command.extend(["-a", "0", wordlist])
    subprocess.run(command)

def crack_hydra(host, service, wordlist):
    """
    Invocando a Hydra, la bestia de múltiples cabezas para atacar servicios mediante fuerza bruta. 
    Dime a quién quieres atacar, con qué servicio y armado con qué diccionario. ¡Vamos allá!
    """
    command = ["hydra", "-L", wordlist, "-P", wordlist, f"{service}://{host}"]
    subprocess.run(command)

def main():
    print("¡Bienvenido al laboratorio de cracking ético de ART!")
    print("1. John the Ripper - El clásico inquebrantable.")
    print("2. Hashcat - El felino feroz de los hashes.")
    print("3. Hydra - La hidra de la fuerza bruta.")

    opcion = input("¿Cuál herramienta te gustaría desatar hoy? Ingresa el número: ")

    if opcion == '1':
        hash_file = input("Ingresa el camino al archivo con los hashes: ")
        wordlist = input("Y si tienes un diccionario, pásamelo también (opcional): ")
        crack_john(hash_file, wordlist)

    elif opcion == '2':
        hash_file = input("Ingresa el camino al archivo con los hashes: ")
        hash_type = input("Dime el tipo de hash (ej: 0 para MD5, 1000 para NTLM): ")
        wordlist = input("Y si tienes un diccionario, pásamelo también (opcional): ")
        crack_hashcat(hash_file, hash_type, wordlist)

    elif opcion == '3':
        host = input("¿Cuál es la dirección IP o nombre del host objetivo? ")
        service = input("¿Qué servicio queremos testear? (ej: ssh, ftp, http) ")
        wordlist = input("Y finalmente, necesito el diccionario de palabras: ")
        crack_hydra(host, service, wordlist)

    else:
        print("Ups, parece que esa opción no es válida. Intenta de nuevo.")

if __name__ == "__main__":
    main()
    print("Recuerda: ¡todo esto es con fines educativos! © ART (Argentina Red Team), todos los derechos reservados.")
